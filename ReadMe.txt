# VideoDownloader
Download videos from pan.baidu.com.

---------------------------------------------
一个从百度网盘网页里下载视频的程序。

---------------------------------------------
2021.9.2 更新：
1 已知在网络不佳或文件太大的时候可能出现视频已开始播放但播放框内总时长显示为--:--的情况，如果此时直接下载streaming文件，会导致最终下载的视频不完整。因此请务必确认视频播放框的时间显示为xx:xx/xx:xx，而不是xx:xx/--:--（x为数字）。
2 尝试了用JavaScript脚本代替第二、三步，失败。因为网页中此部分位于mode为closed的shadow-root接口内，JavaScript脚本无法访问。如果有自动化的解决方案并愿意告知，感激不尽。

---------------------------------------------
2021.8.29 更新：
1 在复制网页源代码内的链接后、整个视频下载完成前，不能关闭或刷新播放视频的页面。可以进行暂停、播放等操作，但不能让网页重新加载。
猜测是因为streaming文件是临时性的，刷新或关闭都会让streaming里的地址失效。
2 若使用火狐浏览器，第二步的查找会找不到，替代方法是搜索html5_api，把搜到的这一段开头的小三角点成朝下的（即展开段落，如果已经朝下就不用点），选取被展开段落里的链接复制（不是通过html5_api查找到的段落），其他操作一样

---------------------------------------------
使用方法：
1 下载exe文件（如果本地支持py环境的话下载py文件也可以）并保存后，使用chrome或火狐等可以查看网页源代码的浏览器，打开想要视频的在线播放界面，等待加载完成开始播放后右键页面任意处，在弹出的窗口中选择“检查”（或在页面内按F12）
2 在新出的窗口中按Ctrl+F查找“pan.baidu.com/api”或“api/streaming”，理论上只会看到唯一一个结果，双击点开后复制这一段里以https开头的链接（Chrome浏览器里似乎在检索时不能直接复制，需要点击查找框边上的Cancel退出查找模式后才能双击复制链接）
3 在新的页面地址栏里粘贴链接，会跳出下载文件的提示，默认文件名应该是“streaming”，格式为m3u8，保存到程序exe文件同目录下
4 运行exe文件，按照要求输入文件名后回车等待。程序完成后会显示“下载完成”，并生成一个以输入的文件名前半部分为名的文件夹
5 用Potplayer或其他可以合并文件为单一文件播放的播放器观看，或者使用格式工厂等软件把视频按编号从小到大的顺序拼起来后观看（后者可能出现音画不同步问题，推荐前者）

声明：
本程序只用作交流和学习，禁止用于任何商业用途；本程序版权归原作者所有，转载时请注明出处；本程序有许多不完善之处，如有修改需要请自行更改py文件；使用前请认真阅读上面的使用方法。